{"ast":null,"code":"var _jsxFileName = \"D:\\\\dev\\\\react\\\\finalProj\\\\Finalproj-frontend\\\\src\\\\pages\\\\testChat\\\\chatWindow.jsx\",\n    _s = $RefreshSig$();\n\nimport { useState, useContext, useEffect } from \"react\";\nimport { chatcontractAddress, chatcontractABI } from \"../chat/chatConstants\";\nimport \"./chatWindow.css\";\nimport { testContext } from \"../../context/testContext\";\nimport Web3 from 'web3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ChatWindow(props) {\n  _s();\n\n  const {\n    parameter\n  } = props;\n  const [msg, setmsg] = useState([]);\n  let web3 = new Web3(window.ethereum);\n  let chatcontract = new web3.eth.Contract(chatcontractABI, chatcontractAddress);\n  let {\n    connectedAccount\n  } = useContext(testContext);\n  var msgs = [];\n  useEffect(() => {\n    chatcontract.getPastEvents('message', {\n      fromBlock: 0,\n      toBlock: 'latest'\n    }, function (err, data) {\n      console.log(data);\n      let x = data.length;\n\n      for (var n = 0; n < x; n++) {\n        if (data[n].returnValues.to.toLowerCase() === connectedAccount) {\n          if (data[n].returnValues.from.toLowerCase() === parameter.toLowerCase()) {\n            msgs.push([data[n].returnValues.message, \"rec\"]); // rec\n          }\n        }\n\n        if (data[n].returnValues.to.toLowerCase() === parameter.toLowerCase()) {\n          if (data[n].returnValues.from.toLowerCase() === connectedAccount) {\n            msgs.push([data[n].returnValues.message, \"snd\"]); //send\n          }\n        }\n      }\n\n      setmsg(msgs);\n    });\n  }, []);\n  console.log(msgs);\n\n  function sendMessage() {\n    var message = msg;\n    var address = parameter;\n    var date = new Date().toLocaleDateString(\"IN\");\n    var time = new Date().toLocaleTimeString(\"IN\");\n    time = time.split('.');\n    var accurateTime = date + ' ' + time[0] + ':' + time[1];\n    chatcontract.methods.sendMessage(address, message, accurateTime).send({\n      from: connectedAccount\n    }, function (err, transcationHash) {\n      if (err) {\n        console.log(err);\n      } else {\n        console.log(\"message sent,trnx hash:\" + transcationHash);\n      }\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'space-between',\n      height: '100%'\n    },\n    children: [parameter, /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"messages\",\n      children: [\"hi  \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 19\n      }, this), \"hii\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        class: \"msg-send-box\",\n        onChange: e => setmsg(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"msg-send-btn\",\n        onClick: () => sendMessage(),\n        children: \" Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 12\n  }, this);\n}\n\n_s(ChatWindow, \"1SbxQu9YKM32dGNEDNcMl+iLQOI=\");\n\n_c = ChatWindow;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatWindow\");","map":{"version":3,"sources":["D:/dev/react/finalProj/Finalproj-frontend/src/pages/testChat/chatWindow.jsx"],"names":["useState","useContext","useEffect","chatcontractAddress","chatcontractABI","testContext","Web3","ChatWindow","props","parameter","msg","setmsg","web3","window","ethereum","chatcontract","eth","Contract","connectedAccount","msgs","getPastEvents","fromBlock","toBlock","err","data","console","log","x","length","n","returnValues","to","toLowerCase","from","push","message","sendMessage","address","date","Date","toLocaleDateString","time","toLocaleTimeString","split","accurateTime","methods","send","transcationHash","display","flexDirection","justifyContent","height","e","target","value"],"mappings":"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","sourcesContent":["import {useState,useContext,useEffect} from \"react\";\r\nimport {chatcontractAddress,chatcontractABI} from \"../chat/chatConstants\";\r\nimport \"./chatWindow.css\"\r\nimport { testContext } from \"../../context/testContext\";\r\nimport Web3 from 'web3';\r\nexport default function ChatWindow(props){\r\n    const { parameter  } = props;\r\n    \r\n    \r\n  const [msg, setmsg] = useState([]);\r\n  \r\n  let web3 = new Web3(window.ethereum)\r\n  let chatcontract = new web3.eth.Contract(chatcontractABI, chatcontractAddress);\r\n     let {\r\n      connectedAccount\r\n    } =  useContext(testContext);\r\n\r\n   \r\n    var msgs=[];\r\n    useEffect(() => {\r\n         chatcontract.getPastEvents('message', {\r\n            fromBlock: 0,\r\n            toBlock: 'latest',\r\n    \r\n          },function (err, data) {\r\n             console.log(data);\r\n            let x = data.length;\r\n            for (var n = 0; n < x; n++) {\r\n                \r\n                if(data[n].returnValues.to.toLowerCase()===connectedAccount){\r\n                    if(data[n].returnValues.from.toLowerCase()===parameter.toLowerCase()){\r\n                        msgs.push([data[n].returnValues.message,\"rec\"]);\r\n                        // rec\r\n                    }\r\n\r\n                }\r\n                if(data[n].returnValues.to.toLowerCase()===parameter.toLowerCase()){\r\n                    if(data[n].returnValues.from.toLowerCase()===connectedAccount){\r\n                        msgs.push([data[n].returnValues.message,\"snd\"]);\r\n                        //send\r\n                    }\r\n\r\n                }\r\n            }\r\n            setmsg(msgs);\r\n          \r\n          });\r\n    }, []);\r\n\r\n  console.log(msgs);\r\n  function sendMessage(){\r\n    var message=msg;\r\n    var address=parameter ;\r\n    var date = new Date().toLocaleDateString(\"IN\");\r\n    var time = new Date().toLocaleTimeString(\"IN\");\r\n    time = time.split('.')\r\n    var accurateTime = date + ' ' + time[0] + ':' + time[1];\r\n    \r\n    chatcontract.methods.sendMessage(address, message, accurateTime).send({ from: connectedAccount }, function (err, transcationHash) {\r\n        if (err) {\r\n            console.log(err);\r\n        }\r\n        else{\r\n            console.log(\"message sent,trnx hash:\"+transcationHash);\r\n        }\r\n    });\r\n  }\r\n\r\n\r\n    return(<div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'space-between', height: '100%' }}>\r\n  \r\n                    {parameter }\r\n        <div class=\"messages\">\r\n              hi  <br />hii\r\n        </div>\r\n\r\n\r\n        <div style={{display:\"flex\"}}>\r\n        <input type=\"text\" class=\"msg-send-box\" onChange={(e)=>setmsg(e.target.value)}  /> \r\n        <div class=\"msg-send-btn\" onClick={()=>sendMessage()}> Send</div> \r\n        </div>\r\n             \r\n    </div>);\r\n}"]},"metadata":{},"sourceType":"module"}